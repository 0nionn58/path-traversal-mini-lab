<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Path Traversal Visualiser</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body      { font-family: monospace; background:#f8f9fa; }
  pre       { font-family:inherit; }
  .selected { border:2px dashed #28a745; padding:2px 6px; background:#eaffea; }
  .danger   { color:red; font-weight:bold; }
</style>
</head>
<body class="container mt-4">

<h2>path Traversal mini lab</h2>
<p>
  Start at <code>?file=report.txt</code> and use <code>../</code> to escape.<br>
</p>
<hr>

<pre>{{ tree|safe }}</pre>

{% if is_image %}
  <hr><h5>🖼️ Image Preview</h5>
  <img src="/raw?file={{ raw }}" class="img-fluid" alt="image preview">
{% elif content %}
  <hr><h5>📄 File Content</h5>
  <pre>{{ content }}</pre>
{% elif error %}
  <hr><h5 class="text-danger">⚠️ {{ error }}</h5>
{% endif %}

</body>
</html>
